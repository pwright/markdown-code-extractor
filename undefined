This should be extracted
Into its own file
